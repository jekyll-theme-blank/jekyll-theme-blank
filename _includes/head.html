{%- assign canonical_url = page.url | absolute_url -%}

{%- comment -%} Converts all "+" to "%2B" so that they become "+" after decoding. ("+" is not escaped in `canonical_url`, while `url_decode` decodes it to a space.) {%- endcomment -%}
{%- assign decoded_canonical_url = canonical_url | replace: '+', '%2B' | url_decode -%}

    <meta charset="UTF-8">

    {%- if site.color_scheme %}
    <meta name="color-scheme" content="{{- site.color_scheme -}}">
    {%- endif %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      {%- if page.title -%}
        {{- page.title -}}
      {%- elsif page.layout == 'post-listing-page' -%}
        {{- site.title -}}
      {%- else -%}
        {%- comment -%} On the individual post page, sets the URL as the title. {%- endcomment -%}
        {{- decoded_canonical_url -}}
      {%- endif -%}
    </title>
    <link rel="canonical" href="{{- canonical_url -}}">

    {%- if site.license_url %}
    <link rel="license" href="{{- site.license_url -}}">
    {%- endif %}
{% if page.layout == 'post' -%}
      {% include post-style.html -%}
    {%- endif -%}
